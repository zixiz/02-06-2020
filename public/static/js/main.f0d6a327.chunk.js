(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{165:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(52),c=t.n(s),l=(t(62),t(2)),o=t(14),m=t(3),i=(t(63),t(64),t(13)),u=t.n(i),d="http://localhost:5000/auth/",p=function(e,a,t){return u.a.post(d+"register",{email:e,full_name:a,password:t})},f=function(e,a){return u.a.post(d+"login",{email:e,password:a}).then((function(e){return e.data.accessToken&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))},b=function(){localStorage.removeItem("user")},v=function(){return JSON.parse(localStorage.getItem("user"))},E=t(16),g=t.n(E),h=t(11),N=t.n(h),j=t(17),O=t.n(j),y=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"This field is required!")},w=function(e){var a=Object(n.useRef)(),t=Object(n.useRef)(),s=Object(n.useState)(""),c=Object(l.a)(s,2),o=c[0],m=c[1],i=Object(n.useState)(""),u=Object(l.a)(i,2),d=u[0],p=u[1],b=Object(n.useState)(!1),E=Object(l.a)(b,2),h=E[0],j=E[1],w=Object(n.useState)(""),S=Object(l.a)(w,2),x=S[0],k=S[1];Object(n.useEffect)((function(){v()&&(e.history.push("/profile"),window.location.reload())}));return r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"card card-container"},r.a.createElement("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),r.a.createElement(g.a,{onSubmit:function(n){n.preventDefault(),k(""),j(!0),a.current.validateAll(),0===t.current.context._errors.length?f(o,d).then((function(a){a.success?(e.history.push("/profile"),window.location.reload()):(k(a.error),j(!1))}),(function(e){var a=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();j(!1),k(a)})):j(!1)},ref:a},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement(N.a,{type:"text",className:"form-control",name:"email",value:o,onChange:function(e){var a=e.target.value;m(a)},validations:[y]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(N.a,{type:"password",className:"form-control",name:"password",value:d,onChange:function(e){var a=e.target.value;p(a)},validations:[y]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary btn-block",disabled:h},h&&r.a.createElement("span",{className:"spinner-border spinner-border-sm"}),r.a.createElement("span",null,"Sign In"))),x&&r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"alert alert-danger",role:"alert"},x)),r.a.createElement(O.a,{style:{display:"none"},ref:t}))))},S=t(53),x=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"This field is required!")},k=function(e){if(!Object(S.isEmail)(e))return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"This is not a valid email.")},C=function(e){if(e.length<4||e.length>40)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"The password must be between 5 and 40 characters.")},T=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"Full Name is required")},F=function(e){var a=Object(n.useRef)(),t=Object(n.useRef)(),s=Object(n.useState)(""),c=Object(l.a)(s,2),o=c[0],m=c[1],i=Object(n.useState)(""),u=Object(l.a)(i,2),d=u[0],f=u[1],b=Object(n.useState)(""),E=Object(l.a)(b,2),h=E[0],j=E[1],y=Object(n.useState)(!1),w=Object(l.a)(y,2),S=w[0],F=w[1],I=Object(n.useState)(""),M=Object(l.a)(I,2),A=M[0],P=M[1];Object(n.useEffect)((function(){v()&&(e.history.push("/profile"),window.location.reload())}));return r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"card card-container"},r.a.createElement("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),r.a.createElement(g.a,{onSubmit:function(e){e.preventDefault(),P(""),F(!1),a.current.validateAll(),0===t.current.context._errors.length&&p(o,h,d).then((function(e){e.data.success?(P("Account successfully created, now you can sign in"),F(!0)):(P(e.data.error),F(!1))}),(function(e){var a=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();P(a),F(!1)}))},ref:a},!S&&r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement(N.a,{type:"text",className:"form-control",name:"email",value:o,onChange:function(e){var a=e.target.value;m(a)},validations:[x,k]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Full Name"),r.a.createElement(N.a,{type:"text",className:"form-control",name:"full_name",value:h,onChange:function(e){var a=e.target.value;j(a)},validations:[x,T]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(N.a,{type:"password",className:"form-control",name:"password",value:d,onChange:function(e){var a=e.target.value;f(a)},validations:[x,C]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary btn-block"},"Sign Up"))),A&&r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:S?"alert alert-success":"alert alert-danger",role:"alert"},A)),S&&r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-success btn-block",onClick:function(){e.history.push("/"),window.location.reload()}},"Go To Sign In")),r.a.createElement(O.a,{style:{display:"none"},ref:t}))))},I=t(12),M=t.n(I),A=t(18);function P(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{"x-access-token":e.accessToken,"Content-Type":"application/json"}:{}}var _="http://localhost:5000/messages/",R=function(){return u.a.get(_+"message/",{headers:P()})},D=function(){return u.a.get(_+"message/?filter=sent",{headers:P()})},J=function(){return u.a.get(_+"users/",{headers:P()})},q=function(e,a,t,n){return u.a.post(_+"message/",{sender:e,reciver:a,message:t,subject:n},{headers:P()})},L=function(e){return u.a.delete(_+"message/".concat(e),{headers:P()})},B=t(28),U=function(e){var a=Object(n.useState)({}),t=Object(l.a)(a,2),s=t[0],c=t[1],o=Object(n.useState)([]),m=Object(l.a)(o,2),i=m[0],u=m[1],d=Object(n.useState)([]),p=Object(l.a)(d,2),f=p[0],b=p[1],E=Object(n.useState)(!1),g=Object(l.a)(E,2),h=(g[0],g[1]),N=Object(n.useState)(!1),j=Object(l.a)(N,2),O=j[0],y=j[1],w=Object(n.useState)(""),S=Object(l.a)(w,2),x=S[0],k=S[1],C=Object(n.useState)(!1),T=Object(l.a)(C,2),F=T[0],I=T[1],P=function(e){return 0===e.length?I(!0):I(!1)};Object(n.useEffect)((function(){h(!0);var e=v();e&&c(e),O?D().then((function(e){b(e.data.response),h(!1),P(e.data.response)})):R().then((function(e){u(e.data.response),h(!1),P(e.data.response)}))}),[O]);var _=function(){var e=Object(A.a)(M.a.mark((function e(){var a,t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O){e.next=13;break}return e.next=3,L(x);case 3:return e.sent,e.next=6,D();case 6:a=e.sent,b(a.data.response),P(a.data.response),h(!1),k(""),e.next=23;break;case 13:return e.next=15,L(x);case 15:return e.sent,e.next=18,R();case 18:t=e.sent,u(t.data.response),P(t.data.response),h(!1),k("");case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("strong",null,"Hello ",s.full_name),r.a.createElement("label",{className:"switch switch-yes-no"},r.a.createElement("input",{onClick:function(){return y(!O)},className:"switch-input",type:"checkbox"}),r.a.createElement("span",{className:"switch-label","data-on":"Sent","data-off":"Inbox"}),r.a.createElement("span",{className:"switch-handle"}))),r.a.createElement("div",{className:"col-sm-9"},F?r.a.createElement("div",{className:"card text-center"},O?r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"There aren't any sent messages yet."),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){e.history.push("/compose"),window.location.reload()}},"Compose Message")):r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"There are no messages yet."))):r.a.createElement("table",{className:"table"},r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,O?r.a.createElement("th",{scope:"col"},"Sender"):r.a.createElement("th",{scope:"col"},"From"),r.a.createElement("th",{scope:"col"},"Subject"),r.a.createElement("th",{scope:"col"},"Message"))),O?r.a.createElement("tbody",null,f.map((function(e){return r.a.createElement("tr",{key:e.id.toString()},r.a.createElement("th",null,e.user.email),r.a.createElement("td",null,e.subject),r.a.createElement("td",{className:"d-flex justify-content-between"},e.message," ",r.a.createElement(B.a,{onClick:function(){return k(e.id.toString())},"data-toggle":"modal","data-target":"#deleteMessagePrompt"})))}))):r.a.createElement("tbody",null,i.map((function(e){return r.a.createElement("tr",{key:e.id.toString()},r.a.createElement("th",null,e.user.email),r.a.createElement("td",null,e.subject),r.a.createElement("td",{className:"d-flex justify-content-between"},e.message," ",r.a.createElement(B.a,{onClick:function(){return k(e.id.toString())},"data-toggle":"modal","data-target":"#deleteMessagePrompt"})))})))))),r.a.createElement("div",{className:"modal fade",id:"deleteMessagePrompt",tabIndex:"-1",role:"dialog","aria-labelledby":"deleteMessagePromptLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"Are you sure you want to DELETE?"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},"This will delete the message for both the sender and reciver."),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal"},"Close"),r.a.createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",onClick:_},"Delete"))))))},W=t(54),G=t.n(W),H=t(55),$=t.n(H),z=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"This field is required!")};function K(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(A.a)(M.a.mark((function e(a){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,a)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V=function(){var e=Object(n.useRef)(),a=Object(n.useRef)(),t=Object(n.useState)([]),s=Object(l.a)(t,2),c=s[0],o=s[1],m=Object(n.useState)(!1),i=Object(l.a)(m,2),u=i[0],d=i[1],p=Object(n.useState)(""),f=Object(l.a)(p,2),b=f[0],E=f[1],h=Object(n.useState)(void 0),j=Object(l.a)(h,2),y=j[0],w=j[1],S=Object(n.useState)(""),x=Object(l.a)(S,2),k=x[0],C=x[1],T=Object(n.useState)({}),F=Object(l.a)(T,2),I=F[0],P=F[1],_=Object(n.useState)(!1),R=Object(l.a)(_,2),D=R[0],L=R[1],B=Object(n.useState)(""),U=Object(l.a)(B,2),W=U[0],H=U[1];Object(n.useEffect)((function(){function e(){return(e=Object(A.a)(M.a.mark((function e(){var a,t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:return a=e.sent,P(a),e.next=6,J();case 6:t=e.sent,o(t.data.response);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var Q=function(){var t=Object(A.a)(M.a.mark((function t(n){var r,s,c;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),H(""),L(!1),d(!0),e.current.validateAll(),0!==a.current.context._errors.length){t.next=36;break}return t.prev=6,r={sender:parseInt(I.id),reciver:parseInt(y),message:b,subject:k},t.next=10,q(r);case 10:if(!(s=t.sent).data.success){t.next=24;break}return H("The Message sent Successfuly"),d(!1),L(!0),t.next=17,K(3e3);case 17:L(!1),H(""),w(void 0),C(""),E(""),t.next=26;break;case 24:H(s.data.error),L(!1);case 26:t.next=34;break;case 28:t.prev=28,t.t0=t.catch(6),c=t.t0.response&&t.t0.response.data&&t.t0.response.data.message||t.t0.message||t.t0.toString(),L(!1),H(c),d(!1);case 34:t.next=37;break;case 36:d(!1);case 37:case"end":return t.stop()}}),t,null,[[6,28]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"}),r.a.createElement("div",{className:"row"},r.a.createElement(g.a,{ref:e,onSubmit:Q,className:"col-md-6 offset-md-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"inputAddress"},"From"),r.a.createElement(N.a,{disabled:!0,type:"text",value:I.email,className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"inputAddress2"},"To"),r.a.createElement($.a,{value:y,name:"sendTo",onChange:function(e){var a=e.target.value;w(a),console.log(a)},className:"form-control",validations:[z]},r.a.createElement("option",{value:!0}," -- select an option -- "),c.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.email)})))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"inputAddress"},"Subject"),r.a.createElement(N.a,{type:"text",value:k,name:"subject",onChange:function(e){var a=e.target.value;C(a)},className:"form-control",validations:[z]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"inputAddress"},"Message"),r.a.createElement(G.a,{type:"text",value:b,name:"emailMessage",onChange:function(e){var a=e.target.value;E(a)},className:"form-control",validations:[z]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary btn-block",disabled:u},u&&r.a.createElement("span",{className:"spinner-border spinner-border-sm"}),r.a.createElement("span",null,"Send Message"))),W&&r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:D?"alert alert-success":"alert alert-danger",role:"alert"},W)),r.a.createElement(O.a,{style:{display:"none"},ref:a}))))},X=function(){var e=Object(n.useState)(void 0),a=Object(l.a)(e,2),t=a[0],s=a[1];Object(n.useEffect)((function(){var e=v();e&&s(e)}),[]);return r.a.createElement(o.a,null,r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-expand navbar-dark bg-dark"},t?r.a.createElement("div",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/compose",className:"nav-link"},"Compose Message")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/profile",className:"nav-link"},"Profile")),r.a.createElement("li",{className:"nav-item "},r.a.createElement("a",{href:"/",className:"nav-link",onClick:function(){b()}},"Log Out"))):r.a.createElement("div",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/",className:"nav-link"},"Sign In")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/register",className:"nav-link"},"Sign Up")))),r.a.createElement("div",{className:"container mt-3"},r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/",component:w}),r.a.createElement(m.a,{exact:!0,path:"/register",component:F}),r.a.createElement(m.a,{exact:!0,path:"/profile",component:U}),r.a.createElement(m.a,{exact:!0,path:"/compose",component:V})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(o.a,null,r.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},57:function(e,a,t){e.exports=t(165)},62:function(e,a,t){},64:function(e,a,t){}},[[57,1,2]]]);
//# sourceMappingURL=main.f0d6a327.chunk.js.map